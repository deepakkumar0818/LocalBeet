const mongoose = require('mongoose');
require('dotenv').config();

// Connect to MongoDB
const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGODB_URI, {
      useNewUrlParser: true,
      useUnifiedTopology: true,
    });
    console.log('âœ… MongoDB Connected for seeding outlets');
  } catch (error) {
    console.error('âŒ MongoDB connection error:', error);
    process.exit(1);
  }
};

// Import the Outlet model
const Outlet = require('../models/Outlet');

// Sample outlets data
const sampleOutlets = [
  {
    outletCode: 'CK-001',
    outletName: 'Central Kitchen - Main',
    outletType: 'Restaurant',
    description: 'Main central kitchen facility handling food preparation and distribution to all outlets',
    address: {
      street: 'Industrial Area, Block 1',
      city: 'Kuwait City',
      state: 'Kuwait',
      zipCode: '12345',
      country: 'Kuwait'
    },
    contactInfo: {
      phone: '+965 1234 5678',
      email: 'central.kitchen@localbeat.com',
      managerName: 'Ahmed Al-Mansouri',
      managerPhone: '+965 9876 5432',
      managerEmail: 'ahmed.mansouri@localbeat.com'
    },
    operatingHours: {
      monday: { open: '06:00', close: '23:00', isOpen: true },
      tuesday: { open: '06:00', close: '23:00', isOpen: true },
      wednesday: { open: '06:00', close: '23:00', isOpen: true },
      thursday: { open: '06:00', close: '23:00', isOpen: true },
      friday: { open: '06:00', close: '23:00', isOpen: true },
      saturday: { open: '06:00', close: '23:00', isOpen: true },
      sunday: { open: '06:00', close: '23:00', isOpen: true }
    },
    capacity: {
      seatingCapacity: 0,
      kitchenCapacity: 500,
      storageCapacity: 1000,
      capacityUnit: 'SQM'
    },
    status: 'Active',
    isCentralKitchen: true,
    features: ['Delivery', 'Catering'],
    timezone: 'Asia/Kuwait',
    notes: 'Main production facility for all outlets',
    createdBy: 'system',
    updatedBy: 'system'
  },
  {
    outletCode: 'OUT-001',
    outletName: 'Kuwait City',
    outletType: 'Restaurant',
    description: 'Premium dining restaurant in the heart of Kuwait City',
    address: {
      street: 'Salem Al-Mubarak Street',
      city: 'Kuwait City',
      state: 'Kuwait',
      zipCode: '12346',
      country: 'Kuwait'
    },
    contactInfo: {
      phone: '+965 2234 5678',
      email: 'downtown@localbeat.com',
      managerName: 'Sarah Al-Rashid',
      managerPhone: '+965 9876 5433',
      managerEmail: 'sarah.rashid@localbeat.com'
    },
    operatingHours: {
      monday: { open: '11:00', close: '23:00', isOpen: true },
      tuesday: { open: '11:00', close: '23:00', isOpen: true },
      wednesday: { open: '11:00', close: '23:00', isOpen: true },
      thursday: { open: '11:00', close: '23:00', isOpen: true },
      friday: { open: '11:00', close: '23:00', isOpen: true },
      saturday: { open: '11:00', close: '23:00', isOpen: true },
      sunday: { open: '11:00', close: '23:00', isOpen: true }
    },
    capacity: {
      seatingCapacity: 120,
      kitchenCapacity: 80,
      storageCapacity: 200,
      capacityUnit: 'SQM'
    },
    status: 'Active',
    isCentralKitchen: false,
    features: ['Dine-in', 'Takeaway', 'Online Ordering'],
    timezone: 'Asia/Kuwait',
    notes: 'Flagship restaurant with premium dining experience',
    createdBy: 'system',
    updatedBy: 'system'
  },
  {
    outletCode: 'OUT-002',
    outletName: '360 Mall',
    outletType: 'Cafe',
    description: 'Cozy cafe by the marina with outdoor seating and coffee specialties',
    address: {
      street: 'Marina Walk, Block 2',
      city: 'Kuwait City',
      state: 'Kuwait',
      zipCode: '12347',
      country: 'Kuwait'
    },
    contactInfo: {
      phone: '+965 3234 5678',
      email: 'marina@localbeat.com',
      managerName: 'Omar Al-Zahra',
      managerPhone: '+965 9876 5434',
      managerEmail: 'omar.zahra@localbeat.com'
    },
    operatingHours: {
      monday: { open: '07:00', close: '22:00', isOpen: true },
      tuesday: { open: '07:00', close: '22:00', isOpen: true },
      wednesday: { open: '07:00', close: '22:00', isOpen: true },
      thursday: { open: '07:00', close: '22:00', isOpen: true },
      friday: { open: '07:00', close: '22:00', isOpen: true },
      saturday: { open: '07:00', close: '22:00', isOpen: true },
      sunday: { open: '07:00', close: '22:00', isOpen: true }
    },
    capacity: {
      seatingCapacity: 60,
      kitchenCapacity: 40,
      storageCapacity: 100,
      capacityUnit: 'SQM'
    },
    status: 'Active',
    isCentralKitchen: false,
    features: ['Dine-in', 'Takeaway', 'Drive-thru', 'Online Ordering'],
    timezone: 'Asia/Kuwait',
    notes: 'Popular cafe with marina views and specialty coffee',
    createdBy: 'system',
    updatedBy: 'system'
  },
  {
    outletCode: 'OUT-003',
    outletName: 'Vibes Complex',
    outletType: 'Food Court',
    description: 'Fast-service food court outlet in major shopping mall',
    address: {
      street: 'Avenues Mall, Food Court Level',
      city: 'Kuwait City',
      state: 'Kuwait',
      zipCode: '12348',
      country: 'Kuwait'
    },
    contactInfo: {
      phone: '+965 4234 5678',
      email: 'mall@localbeat.com',
      managerName: 'Fatima Al-Sabah',
      managerPhone: '+965 9876 5435',
      managerEmail: 'fatima.sabah@localbeat.com'
    },
    operatingHours: {
      monday: { open: '10:00', close: '22:00', isOpen: true },
      tuesday: { open: '10:00', close: '22:00', isOpen: true },
      wednesday: { open: '10:00', close: '22:00', isOpen: true },
      thursday: { open: '10:00', close: '22:00', isOpen: true },
      friday: { open: '10:00', close: '22:00', isOpen: true },
      saturday: { open: '10:00', close: '22:00', isOpen: true },
      sunday: { open: '10:00', close: '22:00', isOpen: true }
    },
    capacity: {
      seatingCapacity: 40,
      kitchenCapacity: 60,
      storageCapacity: 80,
      capacityUnit: 'SQM'
    },
    status: 'Active',
    isCentralKitchen: false,
    features: ['Dine-in', 'Takeaway', 'Online Ordering'],
    timezone: 'Asia/Kuwait',
    notes: 'High-traffic food court location with quick service',
    createdBy: 'system',
    updatedBy: 'system'
  },
  {
    outletCode: 'OUT-004',
    outletName: 'Taiba Hospital',
    outletType: 'Drive-Thru',
    description: 'Express drive-thru outlet for quick service and convenience',
    address: {
      street: 'Highway 30, Exit 5',
      city: 'Kuwait City',
      state: 'Kuwait',
      zipCode: '12349',
      country: 'Kuwait'
    },
    contactInfo: {
      phone: '+965 5234 5678',
      email: 'drivethru@localbeat.com',
      managerName: 'Khalid Al-Mutairi',
      managerPhone: '+965 9876 5436',
      managerEmail: 'khalid.mutairi@localbeat.com'
    },
    operatingHours: {
      monday: { open: '06:00', close: '24:00', isOpen: true },
      tuesday: { open: '06:00', close: '24:00', isOpen: true },
      wednesday: { open: '06:00', close: '24:00', isOpen: true },
      thursday: { open: '06:00', close: '24:00', isOpen: true },
      friday: { open: '06:00', close: '24:00', isOpen: true },
      saturday: { open: '06:00', close: '24:00', isOpen: true },
      sunday: { open: '06:00', close: '24:00', isOpen: true }
    },
    capacity: {
      seatingCapacity: 20,
      kitchenCapacity: 50,
      storageCapacity: 60,
      capacityUnit: 'SQM'
    },
    status: 'Active',
    isCentralKitchen: false,
    features: ['Drive-thru', 'Takeaway', 'Online Ordering'],
    timezone: 'Asia/Kuwait',
    notes: '24/7 drive-thru service for maximum convenience',
    createdBy: 'system',
    updatedBy: 'system'
  }
];

const seedOutlets = async () => {
  try {
    console.log('ðŸŒ± Starting to seed outlets...');
    
    // Clear existing outlets
    await Outlet.deleteMany({});
    console.log('ðŸ—‘ï¸  Cleared existing outlets');
    
    // Insert sample outlets
    const createdOutlets = await Outlet.insertMany(sampleOutlets);
    console.log(`âœ… Successfully created ${createdOutlets.length} outlets:`);
    
    createdOutlets.forEach(outlet => {
      const type = outlet.isCentralKitchen ? 'ðŸ­ Central Kitchen' : 'ðŸª Regular Outlet';
      console.log(`   - ${outlet.outletCode}: ${outlet.outletName} (${type})`);
    });
    
    console.log('\nðŸ“Š Outlet Summary:');
    const centralKitchens = createdOutlets.filter(o => o.isCentralKitchen);
    const regularOutlets = createdOutlets.filter(o => !o.isCentralKitchen);
    
    console.log(`   ðŸ­ Central Kitchens: ${centralKitchens.length}`);
    console.log(`   ðŸª Regular Outlets: ${regularOutlets.length}`);
    console.log(`   ðŸ“ Total Locations: ${createdOutlets.length}`);
    
    console.log('\nðŸŽ‰ Outlet seeding completed successfully!');
    
  } catch (error) {
    console.error('âŒ Error seeding outlets:', error);
  } finally {
    mongoose.connection.close();
    console.log('ðŸ”Œ Database connection closed');
  }
};

// Run the seeding
connectDB().then(() => {
  seedOutlets();
});
